<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Announcements - DavintoHQ</title>
  <link rel="stylesheet" href="styles.css" />
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      query,
      orderBy,
      onSnapshot,
      doc,
      deleteDoc,
      updateDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
    import {
      getAuth,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";const firebaseConfig = {
  apiKey: "AIzaSyDT5tgWOLu3oUf7XTFsFzAuszUcERhoOTw",
  authDomain: "davintohq.firebaseapp.com",
  projectId: "davintohq",
  storageBucket: "davintohq.firebasestorage.app",
  messagingSenderId: "156992522736",
  appId: "1:156992522736:web:7db1c51a089d9d1bad3535",
  measurementId: "G-3GXFN90T6S"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const form = document.getElementById("announcementForm");
const list = document.getElementById("announcementsList");

onAuthStateChanged(auth, (user) => {
  if (!user) {
    window.location.href = "index.html";
  }
});

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const title = form.title.value;
  const content = form.content.value;
  const category = form.category.value;

  if (!title || !content) return;

  await addDoc(collection(db, "announcements"), {
    title,
    content,
    category,
    timestamp: serverTimestamp(),
    pinned: category === "urgent"
  });
  form.reset();
});

const q = query(collection(db, "announcements"), orderBy("timestamp", "desc"));
onSnapshot(q, (snapshot) => {
  list.innerHTML = "";
  snapshot.forEach((docSnap) => {
    const data = docSnap.data();
    const div = document.createElement("div");
    div.className = `announcement ${data.pinned ? 'pinned' : ''}`;
    div.innerHTML = `
      <h3>${data.title}</h3>
      <small>[${data.category || 'info'}]</small>
      <p>${data.content}</p>
      <button onclick="deleteAnnouncement('${docSnap.id}')">Delete</button>
    `;
    list.appendChild(div);
  });
});

window.deleteAnnouncement = async (id) => {
  await deleteDoc(doc(db, "announcements", id));
};

  </script>
</head>
<body>
  <header>
    <h1>üì¢ Announcements</h1>
    <a href="dashboard.html">‚Üê Back to Dashboard</a>
  </header>  <main>
    <form id="announcementForm">
      <input type="text" name="title" placeholder="Title" required />
      <textarea name="content" placeholder="Announcement..." required></textarea>
      <select name="category">
        <option value="info">Info</option>
        <option value="event">Event</option>
        <option value="urgent">Urgent</option>
      </select>
      <button type="submit">Post Announcement</button>
    </form><section id="announcementsList"></section>

  </main>  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f4f4f4;
    }
    header {
      background: #222;
      color: #fff;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    form {
      background: white;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 8px;
    }
    input, textarea, select {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
    }
    #announcementsList {
      margin-top: 1rem;
    }
    .announcement {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    .pinned {
      border-left: 4px solid crimson;
    }
  </style></body>
</html>